2025-12-13 08:28:02,425 - main - INFO - Compaction scheduler starting...
INFO:     Application startup complete.
2025-12-13 08:28:07,371 - main - ERROR - Error in compaction scheduler: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = boolean
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[SQL: SELECT scene_versions.scene_id, count(scene_versions.version_id) AS update_count 
FROM scene_versions 
WHERE scene_versions.created_at < $1::TIMESTAMP WITH TIME ZONE AND scene_versions.is_compacted = false AND scene_versions.compacted_by IS NULL GROUP BY scene_versions.scene_id 
HAVING count(scene_versions.version_id) >= $2::INTEGER ORDER BY count(scene_versions.version_id) DESC 
 LIMIT $3::INTEGER]
[parameters: (datetime.datetime(2025, 12, 12, 7, 28, 2, 425343), 100, 50)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-13 08:28:08,089 - main - ERROR - Error in snapshot scheduler: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: operator does not exist: integer = boolean
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[SQL: SELECT scenes.scene_id 
FROM scenes 
WHERE scenes.snapshot_at < $1::TIMESTAMP WITH TIME ZONE OR scenes.snapshot_at IS NULL OR scenes.yjs_derived = false 
 LIMIT $2::INTEGER]
[parameters: (datetime.datetime(2025, 12, 13, 7, 23, 2, 424690), 10)]
(Background on this error at: https://sqlalche.me/e/20/f405)
